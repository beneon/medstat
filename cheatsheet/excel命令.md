# excel常见公式

## 公式的输入

1. 在任何一个单元格，先输入`=`, 输入公式. 输入的过程中会有自动补全的提示, 可以按上下键选择各种建议, 然后按`TAB`键接受补全
2. 复杂的公式往往需要输入很多的括号, 括号要成对
3. 有两种方式开始公式的录入, 一种是点选一个单元格以后开始输入, 另外一种是点选一个单元格以后, 再点上方的编辑栏开始公式输入. 这两种方式最主要的区别就是左右方向键的功能会不一样: 第一种方法左右方向键会选取旁边的单元格, 第二种方法, 左右方向键会在输入的公式中移动光标

## 基本运算

x | A | B
------- | ------- | -------
1 | v1 | v2
2 | 3 | 8
3 | 4 | 10
4 | 5 | 16
5 | 8 | 11

1. 加`=A2+B2`,减`=A3+B3`,乘`=A4*B4`,除`=A5/B5`
2. 取余数`=MOD(B2,A2)`
3. 平方`=A2^2`, 立方`=A2^3`
4. 开平方`=sqrt(A2)`

## 统计公式

1. 求平均值: `=AVERAGE(A2:A5)`, 如果已经转化成了数据表, 可以这么写:`=AVERAGE(表1[v1])`
2. 求标准差: 除以n的标准差:`=STDEV.P(A2:A5)`, 除以n-1的标准差:`STDEV.S(A2:A5)`.
3. 分布曲线类型函数: excel中包含了包括二项分布, 卡方分布, 正态分布, t分布, 等等众多常用概率分布曲线的计算函数. 这类函数一般包含三个类型的公式:
   1. `.INV`: 给定一个概率, 返回x左侧概率曲线下面积, 比如我们常说正态分布的情况下, 1.96个$\sigma$两侧的面积是0.05, 所以单侧的面积就是0.025, 可以自己在excel中用`=NORM.S.INV(0.025)`验证一下. 这个公式最常用的就是求出特定统计水平下(比如0.05), 用来作为判断的临界统计值是多少, 这样就不用去查统计表了.
   2. `.DIST`: 给定一个x, 返回x左侧概率分布曲线下面积(当cumulative参数为TRUE),或x处概率分布曲线的值(当cumulative参数为FALSE)
   3. `.TEST`: 进行统计检验, 返回精确的p值
4. 正态分布曲线:
   1. 一个正态分布(比如平均值是50, 标准差是8), 某个值(比如40)左侧的正态分布曲线下面积: `=NORM.DIST(40,50,8,TRUE)`
   2. 一个正态分布(比如平均值是50, 标准差是8),两个值(比如40到60)之间的正态分布曲线下面积: `=NORM.DIST(60,50,8,TRUE)-NORM.DIST(40,50,8,TRUE)`
   3. 一个正态分布曲线,(比如均值是50, 标准差是8), 那两个临界值可以让外侧曲线下面积是5%? `=NORM.INV(0.025,50,8)`, `=NORM.INV(1-0.025,50,8)`
5. T分布曲线:
   1. 一个t分布曲线, (单样本, 样本量50, 自由度=50-1=49). t=1.98时, 双尾面积(正负1.98以外的面积): `=T.DIST.2T(1.98, 49)`
   2. 一个t分布曲线, (单样本, 样本量50, 自由度=50-1=49). t=1.98时, 左侧的面积: `=T.DIST(1.98,49,TRUE)`
   3. 一个t分布曲线, (单样本, 样本量50, 自由度49), 双侧面积0.05, 临界值t是多少? `=T.INV.2T(0.05,49)`