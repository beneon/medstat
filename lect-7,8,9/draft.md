# lect.7 卡方检验


## 单样本离散因变量的假设检验

### 卡方检验待检验假设与统计量

对k个类别来说, ($\hat{p_1}, \hat{p_2}, ..., \hat{p_k}$)是各个类别从样本观察到的概率, 而($p_1, p_2, ..., p_k$)则是k个类别的实际概率, 则零假设为:

H0: $p_1=p_{10}, p_2=p_{20}, ..., p_k=p_{k0}$

此时的统计量:卡方值的计算公式是

$\chi = \sum{\frac{(O-E)^2}{E}}$

卡方值比较的是观察值和期望值之间的差的平方,与期望值的比值. 观察值越符合期望值, 这个比值越小.

### 实例

1. 某大学去年对在读学生进行健康调查, 问卷结果提示其中60%的学生没有规律锻炼, 25%偶尔有锻炼, 15%的学生规律锻炼. 随后学校开展了健康促进宣传活动. 一年以后再次做了问卷调查, 访问了470名学生, 得到了下表的结果

分组 | 无规律锻炼 | 偶尔锻炼 | 规律锻炼 | 总数
------- | ------- | ------- | ------- | -------
学生数 | 255 |125 |90 | 470

根据上面的数据, 是否能说明开展了健康宣传促进活动以后, 学生对问卷的回答的分布发生了变化?

像这种评价一个样本里面各类别数量分布是否"符合"一个已知分布的检验,叫做$\chi^2$ goodness of fit检验. 检验的是样本因变量的分布是否"符合"一个特定的分布规律.

### 假设检验5步

1. 确定假设和检验水平

H0: 分布没有变化, 所以今年各类比例和去年的比例是一样的, 也就是$p_1=0.6, p_2=0.25, p_3=0.15$. H1: H0是错的, $\alpha$=0.05

2. 选择统计量

使用卡方值作为统计量($\chi = \sum{\frac{(O-E)^2}{E}}$), 首先要确定符合以下的条件:

    1. $n*p_{10}, n*p_{20},..., n*p_{k0}$均大于等于5
    2. n大于等于40

在本例里面上面条件都满足.

3. 确定判定标准

这个例子里, 自由度d.f.=k-1, (k是组数). 本例自由度是2, 查找自由度是2, 检验水平是0.05的卡方临界值, 得到5.99

4. 计算统计量

分组 | 无规律锻炼 | 偶尔锻炼 | 规律锻炼 | 总数
------- | ------- | ------- | ------- | -------
观察频数 | 255 |125 |90 | 470
期望频数 | 470x0.6 | 470x0.25| 470x0.15|470

计算可得$\chi^2=8.46$

5. 结论

由于8.46大于5.99, 在0.05检测水平上可以拒绝零假设.

## 卡方检验和二项分布检验的关系
## 配对2x2表的检验